{
  "db_name": "PostgreSQL",
  "query": "SELECT t.task_id as \"task_id!\",\n       t.project_id as \"project_id!\",\n       t.queue_name as \"queue_name!\",\n       t.parent_task_id,\n       t.created_at as \"created_at!\",\n       t.updated_at,\n       t.schedule,\n       t.status as \"status!: TaskStatus\",\n       CASE\n           WHEN te.task_id IS NOT NULL THEN jsonb_build_object(\n               'tabular_expirations',\n               jsonb_build_object(\n                   'task_data', row_to_json(te.*),\n                   'tabular', (\n                        SELECT row_to_json(subq)\n                        FROM (\n                            SELECT tab.name as tabular_name,\n                                   n.namespace_name,\n                                   w.warehouse_name\n                            FROM tabular tab\n                            JOIN namespace n ON tab.namespace_id = n.namespace_id\n                            JOIN warehouse w ON n.warehouse_id = w.warehouse_id\n                            WHERE tab.tabular_id = te.tabular_id\n                        ) subq\n                    )\n               )\n           )\n           WHEN tp.task_id IS NOT NULL THEN jsonb_build_object(\n               'tabular_purges',\n               jsonb_build_object(\n                   'task_data', row_to_json(tp.*),\n                   'tabular', (\n                        SELECT row_to_json(subq)\n                        FROM (\n                            SELECT tab.name as tabular_name,\n                                   n.namespace_name,\n                                   w.warehouse_name\n                            FROM tabular tab\n                            JOIN namespace n ON tab.namespace_id = n.namespace_id\n                            JOIN warehouse w ON n.warehouse_id = w.warehouse_id\n                            WHERE tab.tabular_id = te.tabular_id\n                        ) subq\n                    )\n               )\n           )\n           WHEN s.task_id IS NOT NULL THEN jsonb_build_object(\n               'statistics_task',\n               jsonb_build_object(\n                   'task_data', row_to_json(s.*),\n                   'warehouse', (\n                       SELECT row_to_json(ROW(w.warehouse_name))\n                       FROM warehouse w\n                       WHERE w.warehouse_id = s.warehouse_id\n                   )\n               )\n           )\n        END as details\n        FROM task t\n        LEFT JOIN tabular_expirations te ON t.task_id = te.task_id\n        LEFT JOIN tabular_purges tp ON t.task_id = tp.task_id\n        LEFT JOIN statistics_task s ON t.task_id = s.task_id\n        WHERE (t.project_id = $1 OR $1 IS NULL)\n              AND ((t.created_at > $2 OR $2 IS NULL) OR (t.created_at = $2 AND t.task_id > $3))\n        LIMIT $4;",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "task_id!",
        "type_info": "Uuid"
      },
      {
        "ordinal": 1,
        "name": "project_id!",
        "type_info": "Uuid"
      },
      {
        "ordinal": 2,
        "name": "queue_name!",
        "type_info": "Text"
      },
      {
        "ordinal": 3,
        "name": "parent_task_id",
        "type_info": "Uuid"
      },
      {
        "ordinal": 4,
        "name": "created_at!",
        "type_info": "Timestamptz"
      },
      {
        "ordinal": 5,
        "name": "updated_at",
        "type_info": "Timestamptz"
      },
      {
        "ordinal": 6,
        "name": "schedule",
        "type_info": "Text"
      },
      {
        "ordinal": 7,
        "name": "status!: TaskStatus",
        "type_info": {
          "Custom": {
            "name": "schedule_status",
            "kind": {
              "Enum": [
                "enabled",
                "disabled"
              ]
            }
          }
        }
      },
      {
        "ordinal": 8,
        "name": "details",
        "type_info": "Jsonb"
      }
    ],
    "parameters": {
      "Left": [
        "Uuid",
        "Timestamptz",
        "Uuid",
        "Int8"
      ]
    },
    "nullable": [
      true,
      true,
      true,
      true,
      true,
      true,
      true,
      true,
      null
    ]
  },
  "hash": "4686379602737cb16d7d97240bf41bd316fa5375487d0ec40673c40b4411afbb"
}
